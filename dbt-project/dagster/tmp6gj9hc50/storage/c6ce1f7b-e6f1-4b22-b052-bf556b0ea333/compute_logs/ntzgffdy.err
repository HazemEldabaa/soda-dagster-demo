[32m2024-09-24 09:51:33 +0200[0m - dagster - [34mDEBUG[0m - staging_pipeline - c6ce1f7b-e6f1-4b22-b052-bf556b0ea333 - 17223 - LOGS_CAPTURED - Started capturing logs in process (pid: 17223).
[32m2024-09-24 09:51:33 +0200[0m - dagster - [34mDEBUG[0m - staging_pipeline - c6ce1f7b-e6f1-4b22-b052-bf556b0ea333 - 17223 - ingestion - STEP_START - Started execution of step "ingestion".
[32m2024-09-24 09:51:33 +0200[0m - dagster - [34mINFO[0m - staging_pipeline - c6ce1f7b-e6f1-4b22-b052-bf556b0ea333 - ingestion - Check Specs: [AssetCheckSpec(name='ingestion_Invalid_row_count_for_brands_for_checks_for_brands', asset_key=AssetKey(['ingestion']), description=None, additional_deps=[], blocking=False, metadata={}), AssetCheckSpec(name='ingestion_Brand_must_have_ID_for_checks_for_brands', asset_key=AssetKey(['ingestion']), description=None, additional_deps=[], blocking=False, metadata={}), AssetCheckSpec(name='ingestion_Unique_brand_for_checks_for_brands', asset_key=AssetKey(['ingestion']), description=None, additional_deps=[], blocking=False, metadata={}), AssetCheckSpec(name='ingestion_Invalid_row_count_for_stores_for_checks_for_stores', asset_key=AssetKey(['ingestion']), description=None, additional_deps=[], blocking=False, metadata={}), AssetCheckSpec(name='ingestion_Store_must_have_ID_for_checks_for_stores', asset_key=AssetKey(['ingestion']), description=None, additional_deps=[], blocking=False, metadata={}), AssetCheckSpec(name='ingestion_Email_validity_for_checks_for_stores', asset_key=AssetKey(['ingestion']), description=None, additional_deps=[], blocking=False, metadata={}), AssetCheckSpec(name='ingestion_Phone_number_validity_for_checks_for_stores', asset_key=AssetKey(['ingestion']), description=None, additional_deps=[], blocking=False, metadata={}), AssetCheckSpec(name='ingestion_Row_count_for_stocks_for_checks_for_stocks', asset_key=AssetKey(['ingestion']), description=None, additional_deps=[], blocking=False, metadata={}), AssetCheckSpec(name='ingestion_Cross_check_Store_ID_for_checks_for_stocks', asset_key=AssetKey(['ingestion']), description=None, additional_deps=[], blocking=False, metadata={}), AssetCheckSpec(name='ingestion_Cross_check_Product_ID_for_checks_for_stocks', asset_key=AssetKey(['ingestion']), description=None, additional_deps=[], blocking=False, metadata={}), AssetCheckSpec(name='ingestion_No_negative_quantities_for_checks_for_stocks', asset_key=AssetKey(['ingestion']), description=None, additional_deps=[], blocking=False, metadata={}), AssetCheckSpec(name='ingestion_Row_count_for_products_for_checks_for_products', asset_key=AssetKey(['ingestion']), description=None, additional_deps=[], blocking=False, metadata={}), AssetCheckSpec(name='ingestion_Missing_phone_number_for_checks_for_customers', asset_key=AssetKey(['ingestion']), description=None, additional_deps=[], blocking=False, metadata={}), AssetCheckSpec(name='ingestion_Shipment_Late_for_checks_for_orders', asset_key=AssetKey(['ingestion']), description=None, additional_deps=[], blocking=False, metadata={})]
[32m2024-09-24 09:51:33 +0200[0m - dagster - [34mERROR[0m - [31mstaging_pipeline - c6ce1f7b-e6f1-4b22-b052-bf556b0ea333 - ingestion - Error loading bikes/brands.csv: An error occurred (ExpiredToken) when calling the GetObject operation: The provided token has expired.[0m
[32m2024-09-24 09:51:34 +0200[0m - dagster - [34mERROR[0m - [31mstaging_pipeline - c6ce1f7b-e6f1-4b22-b052-bf556b0ea333 - ingestion - Error loading bikes/categories.csv: An error occurred (ExpiredToken) when calling the GetObject operation: The provided token has expired.[0m
[32m2024-09-24 09:51:34 +0200[0m - dagster - [34mERROR[0m - [31mstaging_pipeline - c6ce1f7b-e6f1-4b22-b052-bf556b0ea333 - ingestion - Error loading bikes/customers.csv: An error occurred (ExpiredToken) when calling the GetObject operation: The provided token has expired.[0m
[32m2024-09-24 09:51:34 +0200[0m - dagster - [34mERROR[0m - [31mstaging_pipeline - c6ce1f7b-e6f1-4b22-b052-bf556b0ea333 - ingestion - Error loading bikes/order_items.csv: An error occurred (ExpiredToken) when calling the GetObject operation: The provided token has expired.[0m
[32m2024-09-24 09:51:34 +0200[0m - dagster - [34mERROR[0m - [31mstaging_pipeline - c6ce1f7b-e6f1-4b22-b052-bf556b0ea333 - ingestion - Error loading bikes/orders.csv: An error occurred (ExpiredToken) when calling the GetObject operation: The provided token has expired.[0m
[32m2024-09-24 09:51:34 +0200[0m - dagster - [34mERROR[0m - [31mstaging_pipeline - c6ce1f7b-e6f1-4b22-b052-bf556b0ea333 - ingestion - Error loading bikes/products.csv: An error occurred (ExpiredToken) when calling the GetObject operation: The provided token has expired.[0m
[32m2024-09-24 09:51:34 +0200[0m - dagster - [34mERROR[0m - [31mstaging_pipeline - c6ce1f7b-e6f1-4b22-b052-bf556b0ea333 - ingestion - Error loading bikes/staffs.csv: An error occurred (ExpiredToken) when calling the GetObject operation: The provided token has expired.[0m
[32m2024-09-24 09:51:35 +0200[0m - dagster - [34mERROR[0m - [31mstaging_pipeline - c6ce1f7b-e6f1-4b22-b052-bf556b0ea333 - ingestion - Error loading bikes/stocks.csv: An error occurred (ExpiredToken) when calling the GetObject operation: The provided token has expired.[0m
[32m2024-09-24 09:51:35 +0200[0m - dagster - [34mERROR[0m - [31mstaging_pipeline - c6ce1f7b-e6f1-4b22-b052-bf556b0ea333 - ingestion - Error loading bikes/stores.csv: An error occurred (ExpiredToken) when calling the GetObject operation: The provided token has expired.[0m
[32m2024-09-24 09:51:35 +0200[0m - dagster - [34mERROR[0m - [31mstaging_pipeline - c6ce1f7b-e6f1-4b22-b052-bf556b0ea333 - ingestion - DataFrame missing for index 1. Check if all files are loaded correctly.[0m
[09:51:36] Data source 'soda-dagster' not present in the configuration. Configured data sources: 
[09:51:36] No valid checks found, 0 checks evaluated.
[09:51:36] Data source 'soda-dagster' not present in the configuration. Configured data sources: 
[09:51:36] Data source 'soda-dagster' not present in the configuration. Configured data sources: 
[32m2024-09-24 09:51:36 +0200[0m - dagster - [34mINFO[0m - staging_pipeline - c6ce1f7b-e6f1-4b22-b052-bf556b0ea333 - ingestion - Scan executed successfully.
[32m2024-09-24 09:51:36 +0200[0m - dagster - [34mINFO[0m - staging_pipeline - c6ce1f7b-e6f1-4b22-b052-bf556b0ea333 - ingestion - {'definitionName': 'Soda Dagster Demo', 'defaultDataSource': 'soda-dagster', 'dataTimestamp': '2024-09-24T07:51:35+00:00', 'scanStartTimestamp': '2024-09-24T07:51:35+00:00', 'scanEndTimestamp': '2024-09-24T07:51:36+00:00', 'hasErrors': True, 'hasWarnings': False, 'hasFailures': False, 'metrics': [], 'checks': [], 'checksMetadata': {'count': 0, 'pass': 0, 'warn': 0, 'fail': 0, 'evaluated': 0, 'notEvaluated': 0}, 'queries': [], 'automatedMonitoringChecks': [], 'profiling': [], 'metadata': [], 'logs': [{'level': 'INFO', 'message': 'Soda Library 1.6.1', 'timestamp': '2024-09-24T07:51:35+00:00', 'index': 1, 'doc': None, 'location': None}, {'level': 'INFO', 'message': 'Soda Core 3.0.47', 'timestamp': '2024-09-24T07:51:35+00:00', 'index': 2, 'doc': None, 'location': None}, {'level': 'INFO', 'message': "By downloading and using Soda Library, you agree to Soda's Terms & Conditions (https://go.soda.io/t&c) and Privacy Policy (https://go.soda.io/privacy). ", 'timestamp': '2024-09-24T07:51:35+00:00', 'index': 3, 'doc': None, 'location': None}, {'level': 'ERROR', 'message': "Data source 'soda-dagster' not present in the configuration. Configured data sources: ", 'timestamp': '2024-09-24T07:51:36+00:00', 'index': 4, 'doc': None, 'location': None}, {'level': 'INFO', 'message': 'Scan summary:', 'timestamp': '2024-09-24T07:51:36+00:00', 'index': 5, 'doc': None, 'location': None}, {'level': 'WARNING', 'message': 'No valid checks found, 0 checks evaluated.', 'timestamp': '2024-09-24T07:51:36+00:00', 'index': 6, 'doc': None, 'location': None}, {'level': 'INFO', 'message': '1 errors.', 'timestamp': '2024-09-24T07:51:36+00:00', 'index': 7, 'doc': None, 'location': None}, {'level': 'INFO', 'message': 'Oops! 1 error. 0 failures. 0 warnings. 0 pass.', 'timestamp': '2024-09-24T07:51:36+00:00', 'index': 8, 'doc': None, 'location': None}, {'level': 'INFO', 'message': 'Sending results to Soda Cloud', 'timestamp': '2024-09-24T07:51:36+00:00', 'index': 9, 'doc': None, 'location': None}, {'level': 'ERROR', 'message': "Data source 'soda-dagster' not present in the configuration. Configured data sources: ", 'timestamp': '2024-09-24T07:51:36+00:00', 'index': 10, 'doc': None, 'location': None}, {'level': 'INFO', 'message': 'Soda Cloud Trace: 7280453793608243770', 'timestamp': '2024-09-24T07:51:36+00:00', 'index': 11, 'doc': None, 'location': None}]}
[32m2024-09-24 09:51:36 +0200[0m - dagster - [34mINFO[0m - staging_pipeline - c6ce1f7b-e6f1-4b22-b052-bf556b0ea333 - ingestion - INFO   | Soda Library 1.6.1
INFO   | Soda Core 3.0.47
INFO   | By downloading and using Soda Library, you agree to Soda's Terms & Conditions (https://go.soda.io/t&c) and Privacy Policy (https://go.soda.io/privacy). 
ERROR  | Data source 'soda-dagster' not present in the configuration. Configured data sources: 
INFO   | Scan summary:
WARNING| No valid checks found, 0 checks evaluated.
INFO   | 1 errors.
INFO   | Oops! 1 error. 0 failures. 0 warnings. 0 pass.
INFO   | Sending results to Soda Cloud
ERROR  | Data source 'soda-dagster' not present in the configuration. Configured data sources: 
INFO   | Soda Cloud Trace: 7280453793608243770
[32m2024-09-24 09:51:36 +0200[0m - dagster - [34mINFO[0m - staging_pipeline - c6ce1f7b-e6f1-4b22-b052-bf556b0ea333 - ingestion - Fetching all datasets on page: 0
[32m2024-09-24 09:51:37 +0200[0m - dagster - [34mINFO[0m - staging_pipeline - c6ce1f7b-e6f1-4b22-b052-bf556b0ea333 - ingestion - Fetching all datasets on page: 1
[32m2024-09-24 09:51:37 +0200[0m - dagster - [34mINFO[0m - staging_pipeline - c6ce1f7b-e6f1-4b22-b052-bf556b0ea333 - ingestion - Fetching all datasets on page: 2
[32m2024-09-24 09:51:37 +0200[0m - dagster - [34mINFO[0m - staging_pipeline - c6ce1f7b-e6f1-4b22-b052-bf556b0ea333 - ingestion - Fetching all datasets on page: 3
[32m2024-09-24 09:51:37 +0200[0m - dagster - [34mERROR[0m - [31mstaging_pipeline - c6ce1f7b-e6f1-4b22-b052-bf556b0ea333 - 17223 - ingestion - STEP_FAILURE - Execution of step "ingestion" failed.

dagster._core.errors.DagsterExecutionStepExecutionError: Error occurred while executing op "ingestion"::

ValueError: Check 'Invalid row count for brands' not found in the logs.

Stack Trace:
  File "/Users/hazem/Documents/Soda/GitHub/soda-dagster-demo/.venv/lib/python3.9/site-packages/dagster/_core/execution/plan/utils.py", line 54, in op_execution_error_boundary
    yield
  File "/Users/hazem/Documents/Soda/GitHub/soda-dagster-demo/.venv/lib/python3.9/site-packages/dagster/_utils/__init__.py", line 473, in iterate_with_context
    next_output = next(iterator)
  File "/Users/hazem/Documents/Soda/GitHub/soda-dagster-demo/dbt-project/dagster/pipeline/assets.py", line 702, in ingestion
    passed = check_pass_fail_from_log(logs, spec.name)
  File "/Users/hazem/Documents/Soda/GitHub/soda-dagster-demo/dbt-project/dagster/pipeline/assets.py", line 612, in check_pass_fail_from_log
    raise ValueError(f"Check '{check_name}' not found in the logs.")
[0m
