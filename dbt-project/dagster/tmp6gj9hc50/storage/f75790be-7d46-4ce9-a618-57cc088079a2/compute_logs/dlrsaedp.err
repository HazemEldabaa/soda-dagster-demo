[32m2024-09-18 21:47:27 +0200[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - f75790be-7d46-4ce9-a618-57cc088079a2 - 29550 - LOGS_CAPTURED - Started capturing logs in process (pid: 29550).
[32m2024-09-18 21:47:27 +0200[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - f75790be-7d46-4ce9-a618-57cc088079a2 - 29550 - ingestion - STEP_START - Started execution of step "ingestion".
[32m2024-09-18 21:47:27 +0200[0m - dagster - [34mINFO[0m - __ASSET_JOB - f75790be-7d46-4ce9-a618-57cc088079a2 - ingestion - Check Specs: [AssetCheckSpec(name='ingestion_Invalid_row_count_for_brands_for_checks_for_brands', asset_key=AssetKey(['ingestion']), description=None, additional_deps=[], blocking=False, metadata={}), AssetCheckSpec(name='ingestion_Brand_must_have_ID_for_checks_for_brands', asset_key=AssetKey(['ingestion']), description=None, additional_deps=[], blocking=False, metadata={}), AssetCheckSpec(name='ingestion_Unique_brand_for_checks_for_brands', asset_key=AssetKey(['ingestion']), description=None, additional_deps=[], blocking=False, metadata={}), AssetCheckSpec(name='ingestion_Invalid_row_count_for_stores_for_checks_for_stores', asset_key=AssetKey(['ingestion']), description=None, additional_deps=[], blocking=False, metadata={}), AssetCheckSpec(name='ingestion_Store_must_have_ID_for_checks_for_stores', asset_key=AssetKey(['ingestion']), description=None, additional_deps=[], blocking=False, metadata={}), AssetCheckSpec(name='ingestion_Email_validity_for_checks_for_stores', asset_key=AssetKey(['ingestion']), description=None, additional_deps=[], blocking=False, metadata={}), AssetCheckSpec(name='ingestion_Phone_number_validity_for_checks_for_stores', asset_key=AssetKey(['ingestion']), description=None, additional_deps=[], blocking=False, metadata={}), AssetCheckSpec(name='ingestion_Row_count_for_stocks_for_checks_for_stocks', asset_key=AssetKey(['ingestion']), description=None, additional_deps=[], blocking=False, metadata={}), AssetCheckSpec(name='ingestion_Cross_check_Store_ID_for_checks_for_stocks', asset_key=AssetKey(['ingestion']), description=None, additional_deps=[], blocking=False, metadata={}), AssetCheckSpec(name='ingestion_Cross_check_Product_ID_for_checks_for_stocks', asset_key=AssetKey(['ingestion']), description=None, additional_deps=[], blocking=False, metadata={}), AssetCheckSpec(name='ingestion_No_negative_quantities_for_checks_for_stocks', asset_key=AssetKey(['ingestion']), description=None, additional_deps=[], blocking=False, metadata={}), AssetCheckSpec(name='ingestion_Row_count_for_products_for_checks_for_products', asset_key=AssetKey(['ingestion']), description=None, additional_deps=[], blocking=False, metadata={}), AssetCheckSpec(name='ingestion_Missing_phone_number_for_checks_for_customers', asset_key=AssetKey(['ingestion']), description=None, additional_deps=[], blocking=False, metadata={}), AssetCheckSpec(name='ingestion_Shipment_Late_for_checks_for_orders', asset_key=AssetKey(['ingestion']), description=None, additional_deps=[], blocking=False, metadata={})]
[32m2024-09-18 21:47:27 +0200[0m - dagster - [34mINFO[0m - __ASSET_JOB - f75790be-7d46-4ce9-a618-57cc088079a2 - ingestion - Successfully loaded DataFrame for bikes/brands.csv with 9 rows.
[32m2024-09-18 21:47:27 +0200[0m - dagster - [34mINFO[0m - __ASSET_JOB - f75790be-7d46-4ce9-a618-57cc088079a2 - ingestion - Successfully loaded DataFrame for bikes/categories.csv with 7 rows.
[32m2024-09-18 21:47:27 +0200[0m - dagster - [34mINFO[0m - __ASSET_JOB - f75790be-7d46-4ce9-a618-57cc088079a2 - ingestion - Successfully loaded DataFrame for bikes/customers.csv with 1445 rows.
[32m2024-09-18 21:47:28 +0200[0m - dagster - [34mINFO[0m - __ASSET_JOB - f75790be-7d46-4ce9-a618-57cc088079a2 - ingestion - Successfully loaded DataFrame for bikes/order_items.csv with 4722 rows.
[32m2024-09-18 21:47:28 +0200[0m - dagster - [34mINFO[0m - __ASSET_JOB - f75790be-7d46-4ce9-a618-57cc088079a2 - ingestion - Successfully loaded DataFrame for bikes/orders.csv with 1615 rows.
[32m2024-09-18 21:47:28 +0200[0m - dagster - [34mINFO[0m - __ASSET_JOB - f75790be-7d46-4ce9-a618-57cc088079a2 - ingestion - Successfully loaded DataFrame for bikes/products.csv with 321 rows.
[32m2024-09-18 21:47:28 +0200[0m - dagster - [34mINFO[0m - __ASSET_JOB - f75790be-7d46-4ce9-a618-57cc088079a2 - ingestion - Successfully loaded DataFrame for bikes/staffs.csv with 10 rows.
[32m2024-09-18 21:47:28 +0200[0m - dagster - [34mINFO[0m - __ASSET_JOB - f75790be-7d46-4ce9-a618-57cc088079a2 - ingestion - Successfully loaded DataFrame for bikes/stocks.csv with 939 rows.
[32m2024-09-18 21:47:28 +0200[0m - dagster - [34mINFO[0m - __ASSET_JOB - f75790be-7d46-4ce9-a618-57cc088079a2 - ingestion - Successfully loaded DataFrame for bikes/stores.csv with 3 rows.
INFO:soda.scan:[21:47:29] By downloading and using Soda Library, you agree to Soda's Terms & Conditions (https://go.soda.io/t&c) and Privacy Policy (https://go.soda.io/privacy). 
[32m2024-09-18 21:47:33 +0200[0m - dagster - [34mINFO[0m - __ASSET_JOB - f75790be-7d46-4ce9-a618-57cc088079a2 - ingestion - Successfuly sent failed rows to Missing phone number.csv 
INFO:dagster.builtin:__ASSET_JOB - f75790be-7d46-4ce9-a618-57cc088079a2 - ingestion - Successfuly sent failed rows to Missing phone number.csv 
[32m2024-09-18 21:47:33 +0200[0m - dagster - [34mINFO[0m - __ASSET_JOB - f75790be-7d46-4ce9-a618-57cc088079a2 - ingestion - Successfuly sent failed rows to Shipment Late.csv 
INFO:dagster.builtin:__ASSET_JOB - f75790be-7d46-4ce9-a618-57cc088079a2 - ingestion - Successfuly sent failed rows to Shipment Late.csv 
INFO:soda.scan:[21:47:33] Scan summary:
INFO:soda.scan:[21:47:33] 12/14 checks PASSED: 
INFO:soda.scan:[21:47:33]     brands in soda-dagster
INFO:soda.scan:[21:47:33]       Invalid row count for brands [PASSED]
INFO:soda.scan:[21:47:33]       Brand must have ID [PASSED]
INFO:soda.scan:[21:47:33]       Unique brand [PASSED]
INFO:soda.scan:[21:47:33]     stores in soda-dagster
INFO:soda.scan:[21:47:33]       Invalid row count for stores [PASSED]
INFO:soda.scan:[21:47:33]       Store must have ID [PASSED]
INFO:soda.scan:[21:47:33]       Email validity [PASSED]
INFO:soda.scan:[21:47:33]       Phone number validity [PASSED]
INFO:soda.scan:[21:47:33]     stocks in soda-dagster
INFO:soda.scan:[21:47:33]       Row count for stocks [PASSED]
INFO:soda.scan:[21:47:33]       Cross check Store ID [PASSED]
INFO:soda.scan:[21:47:33]       Cross check Product ID [PASSED]
INFO:soda.scan:[21:47:33]       No negative quantities [PASSED]
INFO:soda.scan:[21:47:33]     products in soda-dagster
INFO:soda.scan:[21:47:33]       Row count for products [PASSED]
INFO:soda.scan:[21:47:33] 2/14 checks FAILED: 
INFO:soda.scan:[21:47:33]     customers in soda-dagster
INFO:soda.scan:[21:47:33]       Missing phone number [FAILED]
INFO:soda.scan:[21:47:33]         check_value: 1267
INFO:soda.scan:[21:47:33]     orders in soda-dagster
INFO:soda.scan:[21:47:33]       Shipment Late [FAILED]
INFO:soda.scan:[21:47:33]         value: 482
INFO:soda.scan:[21:47:33] Oops! 2 failures. 0 warnings. 0 errors. 12 pass.
INFO:soda.scan:[21:47:33] Sending results to Soda Cloud
INFO:soda.scan:[21:47:34] Soda Cloud Trace: 2527020570569195732
[32m2024-09-18 21:47:34 +0200[0m - dagster - [34mERROR[0m - [31m__ASSET_JOB - f75790be-7d46-4ce9-a618-57cc088079a2 - 29550 - ingestion - STEP_FAILURE - Execution of step "ingestion" failed.

dagster._core.errors.DagsterExecutionStepExecutionError: Error occurred while executing op "ingestion"::

TypeError: tuple indices must be integers or slices, not str

Stack Trace:
  File "/Users/hazem/Documents/Soda/GitHub/soda-dagster-demo/.venv/lib/python3.9/site-packages/dagster/_core/execution/plan/utils.py", line 54, in op_execution_error_boundary
    yield
  File "/Users/hazem/Documents/Soda/GitHub/soda-dagster-demo/.venv/lib/python3.9/site-packages/dagster/_utils/__init__.py", line 473, in iterate_with_context
    next_output = next(iterator)
  File "/Users/hazem/Documents/Soda/GitHub/soda-dagster-demo/dbt-project/dagster/pipeline/assets.py", line 646, in ingestion
    check_results = evaluate_checks_from_log(logs, check_specs)
  File "/Users/hazem/Documents/Soda/GitHub/soda-dagster-demo/dbt-project/dagster/pipeline/assets.py", line 385, in evaluate_checks_from_log
    check_name = spec["name"]
[0m
